---
title: "Re: 제로부터 시작하는 zsh 생활"
excerpt: "한순간의 실수가 평생 쌓아온 config들을 날릴 수 있습니다 - 공익광고협의회"

categories:
  - Linux
tags:
  - [Linux, Terminal, zsh]

date: 2022-07-31
toc: true
toc_sticky: true
toc_label: "Re: 제로부터 시작하는 zsh 생활"
---

어제 vim에 새로운 플러그인을 깔던 참이었다.

갑자기 pip 경고가 뜨고 vi가 깡통이 되더니... 설정이 꼬였다.

# 사건의 발단

원래 내 맥은 뭔가 꼬여있었다. 배배 꼬여서 되던게 안 될때도 있고 안 되던게 될 때도 있고(음?)... 그러면 안 되는게 맞긴 하지만 하여튼.

서두에 짧게 언급했듯, vim 플러그인을 설치했는데(c_formatter_42) 매 vim 실행시마다 pip 경고가 뜨고 급기야는 그간 멀쩡했던 nerdtree마저 맛이 가 버렸다.<br>
항상 설정 엎어야지 엎어야지 하던 차라서 이 참에 설정을 싹 엎기로 했다.

## 그런데 제목은 왜 zsh 생활이죠?

실은... pip 관련 경고가 몇 번 나왔다. brew 패키지의 문제로 warning 메시지가 지속적으로 표출되고 있었는데, 이걸 잘못 이해해서 zsh 설정을 엎었다.<br>
pip랑 zsh 설정이랑 개연성이 없다고 생각하겠지만 나는 zsh에 python3을 alias걸고 사용했기 때문에... 관련이 있었고...

### 여러분 echo를 조심하십시오

```bash
echo (명령어) > ~/.zshrc
```

가 모든 zshrc 설정을 엎어버렸다. ㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅋㅜㅜㅜㅜㅠㅠㅠㅠㅠㅠㅠㅠㅠㅠ

한숨만... 그간 쌓아올린 모든 zshrc 설정이 단 한 줄의 명령어로 엎어저버렸다.

# 새로 터미널 세팅하기

한숨만 폭폭 나왔다. 우선 기존에 사용하던 환경을 생각해보면

**zsh**
> Oh-my-zsh<br>powerline10k<br>alias들...

**vim**
> Vundle<br>tagbar<br>ident-guides<br>airline<br>ycm<br>gitgutter<br>fugitive<br>diminactive<br>cpp hightlighting<br>syntastic<br>norminette<br>42header<br>42 c formatter

## 바꿔볼 것

1. omz 벗어나기. <br>왜냐면... 너무 많은 사람들이 사용해서 홍대병인 나에게는 어울리지 않... 은 것은 아니고, 간혹 omz가 내 맥에서 말썽을 일으켰기 때문이다.
2. vundle 버리기. <br>피신 할 적에 급하게 구글링 해서 나온 패키지 매니저였는데, vim-plug가 빠르대서 그걸 써 보고 싶었다.
3. 개인 function 제작. <br>mkdir && cd가 너무 불편해서 그걸 한번에 묶는 func를 만드는 것이 여러 방면에서 좋을 것이라고 생각했다.

## zsh framework

우선 omz는 배제하기로 했으니 omz는 패스, 다른 옵션을 찾아보다가 [starship](starship.rs)이란 프레임웍을 알게 되었고 냅다 설치해봤다.

## vim-plug

vundle에서 vim-plug으로의 마이그레이션은 길지 않으니 패스

## 개인 함수 제작

이것도 쉬웠다.

# 완성된 zsh와 vim

### zshrc
```bash
########## zsh plugins ##########

# starship
eval "$(starship init zsh)"
export STARSHIP_CONFIG=~/.starshiprc

# zsh-autosuggestions
source /Users/munjunsang/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh

# thefuck alias
eval "$(thefuck --alias)"

# colorls
source $(dirname $(gem which colorls))/tab_complete.sh


########## personal settings ##########

# dir function(mkdir && cd)
functions dir() {
	mkdir "$1"
	cd "$1"
}

# clear alias
alias c=clear
alias clr=clear

# python3 vim
alias vi=/opt/homebrew/bin/vim
alias vim=/opt/homebrew/bin/vim

# ls alias
alias l='colorls --group-directories-first --almost-all'
alias ll='colorls --group-directories-first --almost-all --long'

# whereami alias
alias whereami=pwd

# let my zsh case insensetive
autoload -Uz compinit && compinit
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'
```

### vimrc
```vim
language C
scripte utf-8
syntax on
filetype on

set autoindent
set noexpandtab
set tabstop=4
set shiftwidth=4
set list
set clipboard=unnamed      " share clipboard with macOS
set hlsearch               " hightlighting when searching
set smartcase              " smart case senstive
set incsearch              " show search result when typing
set noswapfile             " remove swap file
set hi=100                 " size of history buffer.
set bs=indent,eol,start    " use backspace
set ru                     " always show cursor position
set sc                     " show current typing word
set nu                     " show line number
set hls                    " highlight searching word
set ic                     " ignore case sensitive
set scs                    " enable smart case sensitive 
set ls=2                   " always show the status line
set background=dark        " set background color dark
set ai                     " auto indentation
set si                     " smart indentation
set wmnu                   " show the list of candidates when using tab autocomplete 
set lz                     " disable to update display while using macro
set lpl                    " load plugins when startup
set showmatch              " highlight matching parenthesis
set autoread               " Automatically update the new change in the buffer.
set cino=N-s               " c++ namespace indentation
set cursorline             " current line highlighting
set mouse=a                " use mouse

" ======================== Theme Settings ==============================
colorscheme codedark

" ======================== Plugin Settings =============================
" nerdtree position
let NERDTreeWinPos = "left"
let NERDTreeQuitOnOpen=0

" vim-airline
set laststatus=2 " turn on bottom bar
let g:airline#extensions#tabline#enabled=1       " turn on buffer list
let g:airline#extensions#tabline#fnamemod=':t'   " show only filename
let g:airline_theme='zenburn'
let g:airline#extensions#tabline#enabled=1
let g:airline#extensions#tabline#left_sep=' '
let g:airline#extensions#tabline#left_alt_sep='|'
let g:airline_powerline_fonts=1

" Indent guide
let g:indentguides_spacechar = '┆'
let g:indentguides_tabchar = '|'
let g:indent_guides_enable_on_vim_startup = 0
let g:indent_guides_start_level=2
let g:indent_guides_guide_size=1

" vim-diminactive
let g:diminactive_enable_focus = 1

" vim-cpp syntax highlight
let g:cpp_class_scope_highlight = 1
let g:cpp_member_variable_highlight = 1
let g:cpp_class_decl_highlight = 1
let g:cpp_posix_standard = 1
let g:cpp_experimental_template_highlight = 1
let g:cpp_concepts_highlight = 1
let g:cpp_no_function_highlight = 1

" YouCompleteMe
let g:ycm_global_ycm_extra_conf = '~/.vim/.ycm_extra_conf.py' 
let g:ycm_confirm_extra_conf = 0 
let g:ycm_key_list_select_completion = ['<C-n>']
let g:ycm_key_list_previous_completion=['<C-p>']
if has("unix")
  let s:uname = system("uname")
  if s:uname == "Darwin\n"
	  " MacOSX
	  let g:ycm_server_python_interpreter = '/opt/homebrew/bin/python3'
  else
	  " Linux
	  let g:ycm_server_python_interpreter = '/usr/bin/python3'
  endif
endif
let g:ycm_collect_identifiers_from_comments_and_strings = 1
let g:ycm_complete_in_strings = 1
let g:ycm_complete_in_comments = 1
let g:ycm_min_num_of_chars_for_completion = 1
let g:ycm_filetype_blacklist = {}
let g:ycm_show_diagnostics_ui = 1   " ycm's syntax highlighting

" set username and email for 42header
let g:user42 = 'jumun'
let g:mail42 = 'jumun@student.42seoul.kr'

" ======================== Norminette Settings =========================
" Enable norminette-vim (and gcc)
let g:syntastic_c_checkers = ['norminette', 'gcc']
let g:syntastic_aggregate_errors = 1

" Set the path to norminette (do no set if using norminette of 42 mac)
let g:syntastic_c_norminette_exec = 'norminette'

" Support headers (.h)
let g:c_syntax_for_h = 1
let g:syntastic_c_include_dirs = ['include', '../include', '../../include', 'libft', '../libft/include', '../../libft/include']

" Pass custom arguments to norminette (this one ignores 42header)
let g:syntastic_c_norminette_args = '-R CheckTopCommentHeader'

" Check errors when opening a file (disable to speed up startup time)
let g:syntastic_check_on_open = 1

" Enable error list
let g:syntastic_always_populate_loc_list = 1

" Automatically open error list
let g:syntastic_auto_loc_list = 1

" Skip check when closing
let g:syntastic_check_on_wq = 0

" ==================C Formatter settings========================

" ======================== Plugins =============================

call plug#begin()
Plug 'majutsushi/tagbar'                " Function navigation.
Plug 'nathanaelkane/vim-indent-guides'  " Indentation
Plug 'vim-airline/vim-airline'          " Airline for decoration of vim.
Plug 'vim-airline/vim-airline-themes'   " Airline theme
Plug 'valloric/youcompleteme'           " ycm
Plug 'airblade/vim-gitgutter'           " Git changelog tracker.
Plug 'tpope/vim-fugitive'               " vim with git command(e.g., Gdiff)
Plug 'blueyed/vim-diminactive'          " Highlight the current working window.
Plug 'octol/vim-cpp-enhanced-highlight' " C++ code highlighting.
Plug 'vim-syntastic/syntastic'          " vim syntax
Plug 'alexandregv/norminette-vim'       " set norminette
Plug '42Paris/42header'                 " 42 header
Plug 'cacharle/c_formatter_42.vim'      " 42 Formatter
call plug#end()


" ======================== Special Settings =============================
syntax on                   " auto syntax highlight
filetype plugin indent on

set whichwrap+=h,l,<,>   " auto line switching at the end of line
set listchars=tab:»\ ,extends:›,precedes:‹,nbsp:·,trail:·
hi SpecialKey guifg=darkgrey ctermfg=darkgrey

map aaa :CFormatter42
```

### starshiprc
```toml
format = """
$username\
$directory\
$git_branch\
$git_status\
$line_break\
$character
"""

[character]
success_symbol = "[❯](purple)"
error_symbol = "[❯](red)"
vicmd_symbol = "[❮](green)"

[username]
show_always = true
style_user = "bg:159 black"
style_root = "bg:159 red"
format = '[  ]($style)'

[directory]
style = "bg:166"
format = "[ $path ]($style)"
truncation_length = 3
truncation_symbol = "…/"

[directory.substitutions]
"Documents" = " "
"Downloads" = " "
"Music" = " "
"Pictures" = " "

[git_branch]
symbol = ""
style = "bg:15 black"
format = '[[ $symbol $branch ](bg:15 black)]($style)'


[git_status]
format = "[$all_status$ahead_behind ](bg:8)"
conflicted = "[ ✘✘](bg:8 196)"
ahead = "[ ⇡$count](bg:8 46)"
behind = "[ ⇣$count](bg:8 27)"
diverged = "[ ⇕](bg:8 202)"
up_to_date = "[ ✓](bg:8 40)"
untracked = "[ ?$count](bg:8 220)"
stashed = "[ $](bg:8 135)"
modified = "[ !](bg:8 202)"
staged = '[ +$count](bg:8 green)'
renamed = "[ »](bg:8 91)"
deleted = "[ ✘](bg:8 196)"
```

휴. 길다.